#確率的代入法は乱数を用いるので，同じ結果を再現できるように，乱数のシード値を固定する．
#括弧の中の数字は任意の整数である．
set.seed(1)

#代入モデル（model4）の残差を計算して，resid1と名付ける．
resid1 <- residuals(model4)

#代入モデル（model4）の残差の標準偏差を計算して，sde1と名付ける．
sde1 <-sd (resid1)

#新しい変数z3を作って，その中身はzと同じものとして生成する．
z3 <- z

#length関数は，ベクトルの長さを測る関数である．つまり，ある変数に含まれるデータの個数を表す．
#[]の中は「k1が0であるならば」という意味であるから，欠測値に該当する部分のyのデータの個数を計算して，n2と名付けている．
#今回のデータでは，n2は482である．
n2 <- length(y[k1==0])

#rnorm関数は，正規分布に従う乱数を生成する関数
#平均ゼロ，標準偏差sde1の乱数をn2個生成する．
E1 <- rnorm(n2, 0, sde1)

#a0 + a1 * y[k1==0]の部分が予測のためのモデルの部分である．
#この部分にE1という乱数を加えることで，上下にばらつきを持たせる．
z3[k1==0] <- a0 + a1 * y[k1==0] + E1

#mean関数とsd関数で，z3の平均値と標準偏差を計算
mean(z3)
sd(z3)
